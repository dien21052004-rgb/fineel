<!doctype html>
<html lang="vi" class="light-style layout-menu-fixed layout-compact" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gi√°m S√°t Pha 3</title>

  <!-- Base path cho GitHub Pages -->
  <script>
    if (location.hostname === "dien21052004-rgb.github.io") {
      document.write('<base href="https://dien21052004-rgb.github.io/3/">');
    } else {
      document.write('<base href="./">');
    }
  </script>

  <link rel="icon" type="image/x-icon" href="assets/img/favicon/favicon.ico" />
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="assets/vendor/fonts/boxicons.css" />
  <link rel="stylesheet" href="assets/vendor/css/core.css" />
  <link rel="stylesheet" href="assets/vendor/css/theme-default.css" />

  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/highcharts-more.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/accessibility.js"></script>
  <script src="https://www.unpkg.com/@eohjsc/era-widget@1.1.3/src/index.js"></script>

  <style>
    body {
      font-family: 'Public Sans', sans-serif;
      background-color: #f1f3f6;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    .header-card {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 2px solid #007bff;
      border-radius: 10px;
      padding: 24px;
      background-color: #f8f9fa;
      box-shadow: 0 0 12px rgba(0, 123, 255, 0.2);
      flex-wrap: wrap;
      gap: 20px;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }
      .project-title {
    color: #1E40AF; /* xanh d∆∞∆°ng ƒë·∫≠m */
    font-weight: 700;
  }

  .project-info {
    color: #000; /* m√†u ƒëen */
    font-size: 16px;
    margin: 4px 0;
  }
    .header-left h2 {
      margin: 0 0 8px 0;
      color: #0d6efd;
      font-weight: 700;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    .header-left p {
      margin: 4px 0;
      font-size: 16px;
      color: #333;
    }
    .header-right {
      background: linear-gradient(135deg, #f8f9fa, #e9f0f9);
      border-radius: 20px;
      width: 320px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 0 12px rgba(0, 123, 255, 0.2);
    }
    .header-right h5 {
      font-weight: bold;
      margin-bottom: 20px;
    }
    .flex-center {
      display: flex;
      justify-content: space-around;
      align-items: center;
    }
    .card-row {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 20px;
    }
    .card {
      flex: 1 1 calc(33.33% - 20px);
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      text-align: center;
      min-width: 250px;
    }
    .card h5 {
      margin-bottom: 10px;
    }
    .gauge-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 20px;
      margin-top: 20px;
    }
    .relay-box {
      border: 2px solid #e0e0e0;
      border-radius: 14px;
      padding: 16px;
      background: linear-gradient(145deg, #ffffff, #f3f4f6);
      box-shadow: 2px 2px 6px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    .relay-box.on {
      background: linear-gradient(145deg, #e8f9f0, #d1f7e2);
      border-color: #22c55e;
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.5);
    }
    .relay-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .relay-title {
      font-weight: 600;
    }
    .relay-light {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background-color: #9ca3af;
      box-shadow: inset 0 0 4px rgba(0,0,0,0.3);
      transition: all 0.4s ease;
    }
    .relay-light.on {
      background-color: #22c55e;
      box-shadow: 0 0 12px #4ade80, 0 0 24px #86efac;
    }
    .relay-status {
      font-weight: 600;
      font-size: 14px;
      margin-top: 5px;
    }
    .relay-status.on { color: #22c55e; }
    .relay-status.off { color: #6b7280; }
    .btn { border-radius: 20px; padding: 4px 14px; font-weight: 500; margin: 2px; }
    .btn-outline-success:hover { background-color: #22c55e; color: white; }
    .btn-outline-danger:hover { background-color: #ef4444; color: white; }
    input[type="number"] { max-width: 180px; text-align: center; }
    @media(max-width: 992px){
      .card { flex: 1 1 100%; }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header-card">
      <div class="header-left">
        <img src="https://cdn.haitrieu.com/wp-content/uploads/2021/12/Logo-DH-Thu-Dau-Mot-TDMU.png" alt="Logo TDMU" style="height:80px;">
      </div>
            <div>
            <h2 class="project-title">ƒê·ªÄ T√ÄI: GI√ÅM S√ÅT PHA 3</h2>
            <p class="project-info"><strong>GVHD:</strong> Nguy·ªÖn VƒÉn B√¨nh</p>
            <p class="project-info"><strong>SVTH:</strong><br>L√™ Ph∆∞·ªõc Nguy√™n<br>Nguy·ªÖn Hu·ª≥nh Ng·ªçc ƒêi·ªÅn ‚Äî MSSV: 2225202160107</p>
            </div>

      <div class="header-right">
        <h5>üå°Ô∏è Nhi·ªát ƒë·ªô STM & ESP32</h5>
        <div class="flex-center">
          <div>
            <p class="text-muted mb-1">Nhi·ªát ƒë·ªô STM</p>
            <h3 id="tempstm" class="text-danger fw-bold">-- ¬∞C</h3>
          </div>
          <div style="width:2px; height:60px; background-color:#dee2e6;"></div>
          <div>
            <p class="text-muted mb-1">Nhi·ªát ƒë·ªô ESP32</p>
            <h3 id="tempesp32" class="text-success fw-bold">-- ¬∞C</h3>
          </div>
        </div>
      </div>
    </div>

    <!-- Card c√¥ng su·∫•t, cosœÜ -->
    <div class="card-row">
      <div class="card">
        <h5 class="text-primary">COS œÜ 3 PHA</h5>
        <p>Pha A</p><h4 id="cosA">--</h4>
        <p>Pha B</p><h4 id="cosB">--</h4>
        <p>Pha C</p><h4 id="cosC">--</h4>
      </div>
      <div class="card">
        <h5 class="text-danger">C√îNG SU·∫§T 3 PHA (kW)</h5>
        <p>Pha A</p><h4 id="P_1">--</h4>
        <p>Pha B</p><h4 id="P_2">--</h4>
        <p>Pha C</p><h4 id="P_3">--</h4>
      </div>
      <div class="card">
        <h5 class="text-success">C√îNG SU·∫§T BI·ªÇU KI·∫æN (kVA)</h5>
        <p>Pha A</p><h4 id="V_A">--</h4>
        <p>Pha B</p><h4 id="V_B">--</h4>
        <p>Pha C</p><h4 id="V_C">--</h4>
      </div>
    </div>

    <!-- ƒê·ªìng h·ªì gauge -->
    <div class="gauge-row">
      <div id="gaugeA" style="width: 30%; min-width:250px; height:250px;"></div>
      <div id="gaugeB" style="width: 30%; min-width:250px; height:250px;"></div>
      <div id="gaugeC" style="width: 30%; min-width:250px; height:250px;"></div>
      <div id="gaugeSA" style="width: 30%; min-width:250px; height:250px;"></div>
      <div id="gaugeSB" style="width: 30%; min-width:250px; height:250px;"></div>
      <div id="gaugeSC" style="width: 30%; min-width:250px; height:250px;"></div>
    </div>

    <!-- Relay -->
    <div class="card-row" id="relayContainer">
      <!-- Relay s·∫Ω t·∫°o b·∫±ng JS -->
    </div>

    <!-- D√≤ng ƒëi·ªán b·∫£o v·ªá -->
    <div class="card" style="margin-top:20px; text-align:center;">
      <h5 class="text-primary">C·∫§U H√åNH D√íNG ƒêI·ªÜN B·∫¢O V·ªÜ</h5>
      <p class="text-muted">Nh·∫≠p gi√° tr·ªã d√≤ng ƒëi·ªán ng∆∞·ª°ng (A) √°p d·ª•ng cho c·∫£ 3 pha</p>
      <input type="number" id="protectAll" placeholder="Nh·∫≠p gi√° tr·ªã (A)" min="0" step="0.1">
      <button id="sendProtect" class="btn btn-success">X√°c Nh·∫≠n</button>
    </div>
  </div>

  <script>
    const relayContainer = document.getElementById('relayContainer');
    for(let i=1;i<=8;i++){
      const div = document.createElement('div');
      div.classList.add('card');
      div.innerHTML = `
        <div class="relay-box" id="relayBox${i}">
          <div class="relay-header">
            <span class="relay-title">Relay ${i}</span>
            <div id="relayLight${i}" class="relay-light"></div>
          </div>
          <small id="statusLed${i}" class="relay-status off">T·∫Øt</small>
          <div style="margin-top:10px;">
            <button id="${i}turnOn" class="btn btn-outline-success btn-sm">B·∫≠t</button>
            <button id="${i}turnOff" class="btn btn-outline-danger btn-sm">T·∫Øt</button>
          </div>
        </div>
      `;
      relayContainer.appendChild(div);
    }

    // Highcharts gauge functions
    function createGauge(container, title, color, max=400) {
      return Highcharts.chart(container, {
        chart: { type: 'gauge', height: 250, backgroundColor: 'transparent' },
        title: { text: title },
        pane: { startAngle: -150, endAngle: 150 },
        yAxis: {
          min: 0, max: max, tickInterval: max/8,
          plotBands:[
            {from:0,to:max/2,color:'#55BF3B'},
            {from:max/2,to:max*0.75,color:'#DDDF0D'},
            {from:max*0.75,to:max,color:'#DF5353'}
          ],
          title:{text:max===400?'V':'A'}
        },
        series:[{name:title,data:[0],dial:{backgroundColor:color},tooltip:{valueSuffix:max===400?' V':' A'}}]
      });
    }

    const gaugeA = createGauge('gaugeA','ƒêi·ªán √Åp Pha A','#007bff');
    const gaugeB = createGauge('gaugeB','ƒêi·ªán √Åp Pha B','#ff9800');
    const gaugeC = createGauge('gaugeC','ƒêi·ªán √Åp Pha C','#4caf50');
    const gaugeSA = createGauge('gaugeSA','D√≤ng ƒêi·ªán Pha A','#28a745',20);
    const gaugeSB = createGauge('gaugeSB','D√≤ng ƒêi·ªán Pha B','#ffc107',20);
    const gaugeSC = createGauge('gaugeSC','D√≤ng ƒêi·ªán Pha C','#17a2b8',20);

    // EraWidget integration: b·∫°n c√≥ th·ªÉ copy ph·∫ßn JS t·ª´ m√£ c≈©
    // eraWidget.init(...) 
      <!-- T·∫£i th∆∞ vi·ªán Era Widget -->

 

    // L·∫•y c√°c ph·∫ßn t·ª≠ HTML d·ª±a tr√™n ID, li√™n k·∫øt v·ªõi giao di·ªán ng∆∞·ªùi d√πng
    const power1 = document.getElementById('P_1');
    const power2 = document.getElementById('P_2');
    const power3 = document.getElementById('P_3');
    const powerS1 = document.getElementById('V_A');
    const powerS2 = document.getElementById('V_B');
    const powerS3 = document.getElementById('V_C');
    const cosA = document.getElementById('cosA');
    const cosB = document.getElementById('cosB');
    const cosC = document.getElementById('cosC')
    const VoltA = document.getElementById('gaugeA');
    const VoltB = document.getElementById('gaugeB');
    const VoltC = document.getElementById('gaugeC')
    const CurentA = document.getElementById('gaugeSA');
    const CurentB = document.getElementById('gaugeSB');
    const CurentC = document.getElementById('gaugeSC') ;   
    const turnOnrelay1 = document.getElementById('1turnOn');
    const turnOffrelay1 = document.getElementById('1turnOff');
    const turnOnrelay2 = document.getElementById('2turnOn');
    const turnOffrelay2 = document.getElementById('2turnOff');
    const turnOnrelay3 = document.getElementById('3turnOn');
    const turnOffrelay3 = document.getElementById('3turnOff');
    const turnOnrelay4 = document.getElementById('4turnOn');
    const turnOffrelay4 = document.getElementById('4turnOff');
    const turnOnrelay5 = document.getElementById('5turnOn');
    const turnOffrelay5 = document.getElementById('5turnOff');
    const turnOnrelay6 = document.getElementById('6turnOn');
    const turnOffrelay6 = document.getElementById('6turnOff');
    const turnOnrelay7 = document.getElementById('7turnOn');
    const turnOffrelay7 = document.getElementById('7turnOff');
    const turnOnrelay8 = document.getElementById('8turnOn');
    const turnOffrelay8 = document.getElementById('8turnOff');
    // const SENDONG = document.getElementById('sendProtect');   
    const statusLed1 = document.getElementById('statusLed1');
    const statusLed2 = document.getElementById('statusLed2');
    const statusLed3 = document.getElementById('statusLed3'); 
    const statusLed4 = document.getElementById('statusLed4');
    const statusLed5 = document.getElementById('statusLed5');
    const statusLed6 = document.getElementById('statusLed6');
    const statusLed7 = document.getElementById('statusLed7');
    const statusLed8 = document.getElementById('statusLed8');
    const inputProtectFrom = document.getElementById("protectAll");
    const sendProtect = document.getElementById("sendProtect");
    const relayLight1 = document.getElementById('relayLight1');
    const Tempstm = document.getElementById("tempstm");
    const Tempsp32 = document.getElementById('tempesp32');
    // Bi·∫øn ƒë·ªÉ l∆∞u c·∫•u h√¨nh v√† tr·∫°ng th√°i hi·ªán t·∫°i
    let configPower1 = null, configPower2 = null, configPower3 = null;
    let configPowerS1 = null, configPowerS2 = null, configPowerS3 = null;
    let configCosA = null, configCosB = null, configCosC = null;
    let configCurrentA=null, configCurrentB=null, configCurrentC=null;
    let configVoltA=null, configVoltB=null, configVoltC=null;
    let statusRL1 = null;
    let configTempSTM = null, configTempESP32 = null;
    let configLed1 = null, newStatusLed1 = null, actions1 = [];
    let configLed2 = null, newStatusLed2 = null, actions2 = [];
    let configLed3 = null, newStatusLed3 = null, actions3 = [];
    let configLed4 = null, newStatusLed4 = null, actions4 = [];
    let configLed5 = null, newStatusLed5 = null, actions5 = [];
    let configLed6 = null, newStatusLed6 = null, actions6 = [];
    let configLed7 = null, newStatusLed7 = null, actions7 = [];
    let configLed8 = null, newStatusLed8 = null, actions8 = [];
    let configProtectFrom = null, newSProtectFrom = null, actions9 = [];

    const eraWidget = new EraWidget();
    eraWidget.init({
      needRealtimeConfigs: true,         /* C·∫ßn gi√° tr·ªã hi·ªán th·ªùi */
      needHistoryConfigs: true,          /* C·∫ßn gi√° tr·ªã l·ªãch s·ª≠ */
      needActions: true,                 /* C·∫ßn c√°c h√†nh ƒë·ªông (v√≠ d·ª• B·∫≠t/T·∫Øt ƒë√®n) */
      maxRealtimeConfigsCount: 26,        /* S·ªë l∆∞·ª£ng t·ªëi ƒëa gi√° tr·ªã hi·ªán th·ªùi */
      maxHistoryConfigsCount: 1,         /* S·ªë l∆∞·ª£ng t·ªëi ƒëa gi√° tr·ªã l·ªãch s·ª≠ */
      maxActionsCount: 17,                /* S·ªë l∆∞·ª£ng t·ªëi ƒëa c√°c h√†nh ƒë·ªông c√≥ th·ªÉ k√≠ch ho·∫°t */
      minRealtimeConfigsCount: 0,        /* S·ªë l∆∞·ª£ng t·ªëi thi·ªÉu gi√° tr·ªã hi·ªán th·ªùi */
      minHistoryConfigsCount: 0,         /* S·ªë l∆∞·ª£ng t·ªëi thi·ªÉu gi√° tr·ªã l·ªãch s·ª≠ */
      minActionsCount: 0,                /* S·ªë l∆∞·ª£ng t·ªëi thi·ªÉu h√†nh ƒë·ªông */
      needRealtimeConfigs: true,

      /* H√†m callback ƒë∆∞·ª£c g·ªçi khi c√≥ c·∫•u h√¨nh ƒë∆∞·ª£c nh·∫≠n t·ª´ server */
      onConfiguration: (configuration) => {



        // L∆∞u c√°c c·∫•u h√¨nh khi nh·∫≠n ƒë∆∞·ª£c t·ª´ widget
        configPower1 = configuration.realtime_configs[0];
        configPower2 = configuration.realtime_configs[1];
        configPower3 = configuration.realtime_configs[2];    // L∆∞u c·∫•u h√¨nh nhi·ªát ƒë·ªô
        configPowerS1 = configuration.realtime_configs[3];
        configPowerS2 = configuration.realtime_configs[4];
        configPowerS3 = configuration.realtime_configs[5];   // L∆∞u c·∫•u h√¨nh ƒë·ªô ·∫©m
        configLed1 = configuration.realtime_configs[6];
        configLed2 = configuration.realtime_configs[7];   // L∆∞u c·∫•u h√¨nh ƒë√®n LED
        configLed3 = configuration.realtime_configs[8];
        configCosA = configuration.realtime_configs[9];
        configCosB = configuration.realtime_configs[10];
        configCosC = configuration.realtime_configs[11];
        configLed4 = configuration.realtime_configs[12];
        configLed5 = configuration.realtime_configs[13];   // L∆∞u c·∫•u h√¨nh ƒë√®n LED
        configLed6 = configuration.realtime_configs[14];
        configLed7 = configuration.realtime_configs[15];   // L∆∞u c·∫•u h√¨nh ƒë√®n LED
        configLed8 = configuration.realtime_configs[16];
        configProtectFrom = configuration.realtime_configs[17];
        configTempESP32 = configuration.realtime_configs[18];
        configTempSTM = configuration.realtime_configs[19];
        configVoltA=configuration.realtime_configs[20];
        configVoltB=configuration.realtime_configs[21];
        configVoltC=configuration.realtime_configs[22];
        configCurrentA=configuration.realtime_configs[23];
        configCurrentB=configuration.realtime_configs[24];
        configCurrentC=configuration.realtime_configs[25];
        // configprotectAll = configuration.realtime_configs[17];       
        actions1 = configuration.actions.slice(0, 2);
        actions2 = configuration.actions.slice(2, 4);
        actions3 = configuration.actions.slice(4, 6);
        actions4 = configuration.actions.slice(6, 8);
        actions5 = configuration.actions.slice(8, 10);
        actions6 = configuration.actions.slice(10, 12);
        actions7 = configuration.actions.slice(12, 14);
        actions8 = configuration.actions.slice(14, 16);
        actions9 = configuration.actions.slice(16, 17);


      },

      /* H√†m callback ƒë∆∞·ª£c g·ªçi khi nh·∫≠n gi√° tr·ªã m·ªõi t·ª´ server */
      onValues: (values) => {
        // C·∫≠p nh·∫≠t gi√° tr·ªã nh·∫≠n ƒë∆∞·ª£c t·ª´ widget
        const valuePower1 = values[configPower1.id].value;
        const valuePower2 = values[configPower2.id].value;
        const valuePower3 = values[configPower3.id].value;
        const valueS1POWER = values[configPowerS1.id].value;
        const valueS2POWER = values[configPowerS2.id].value;
        const valueS3POWER = values[configPowerS3.id].value;
        const valueTempSTM = values[configTempSTM.id].value;
        const valueTempESP32 = values[configTempESP32.id].value;
        const valueVoltA=values[configVoltA.id].value;
        const valueVoltB=values[configVoltB.id].value;
        const valueVoltC=values[configVoltC.id].value;
        const valueCurrentA=values[configCurrentA.id].value;
        const valueCurrentB=values[configCurrentB.id].value;
        const valueCurrentC=values[configCurrentC.id].value;  
        // const valueprotectAll = values[configprotectAll.id].value;
        const valueLed1 = values[configLed1.id].value;
        const valueLed2 = values[configLed2.id].value;
        const valueLed3 = values[configLed3.id].value;
        const valueLed4 = values[configLed4.id].value;
        const valueLed5 = values[configLed5.id].value;
        const valueLed6 = values[configLed6.id].value;
        const valueLed7 = values[configLed7.id].value;
        const valueLed8 = values[configLed8.id].value;
        const valueCosA = values[configCosA.id].value;
        const valueCosB = values[configCosB.id].value;
        const valueCosC = values[configCosC.id].value;
        const fromValue = values[configProtectFrom.id].value;

        // C·∫≠p nh·∫≠t giao di·ªán ng∆∞·ªùi d√πng v·ªõi gi√° tr·ªã m·ªõi
        power1.innerHTML = valuePower1 + ' Kwh';
        power2.innerHTML = valuePower2 + ' Kwh';
        power3.innerHTML = valuePower3 + ' Kwh';

        powerS1.innerHTML = valueS1POWER + ' VA';
        powerS2.innerHTML = valueS2POWER + ' VA';
        powerS3.innerHTML = valueS3POWER + ' VA';

        Tempstm.innerHTML = valueTempSTM + "‚ÑÉ";
        Tempsp32.innerHTML = valueTempESP32 + "‚ÑÉ";

        cosA.innerHTML = valueCosA;
        cosB.innerHTML = valueCosB;
        cosC.innerHTML = valueCosC;

        gaugeA.series[0].points[0].update(valueVoltA);
        gaugeB.series[0].points[0].update(valueVoltB);
        gaugeC.series[0].points[0].update(valueVoltC);

        
        gaugeSA.series[0].points[0].update(valueCurrentA);
        gaugeSB.series[0].points[0].update(valueCurrentB);
        gaugeSC.series[0].points[0].update(valueCurrentC);

        if (newStatusLed1 !== valueLed1) {
          newStatusLed1 = valueLed1;
          const relayBox1 = document.getElementById('relayBox1');
          const relayLight1 = document.getElementById('relayLight1');
          if (valueLed1 === 1) {
            statusLed1.innerHTML = 'RELAY 1  ƒëang b·∫≠t';  
            statusLed1.classList.add('on');
            statusLed1.classList.remove('off');
            relayLight1.classList.add('on');
            relayBox1.classList.add('on');
          } else {
            statusLed1.innerHTML = 'RELAY 1 ƒëang t·∫Øt';
            statusLed1.classList.remove('on');
            statusLed1.classList.add('off');
            relayLight1.classList.remove('on');
            relayBox1.classList.remove('on');
          }
        }
        if (newStatusLed2 !== valueLed2) {
          newStatusLed2 = valueLed2;
          const relayBox2 = document.getElementById('relayBox2');
          const relayLight2 = document.getElementById('relayLight2');
          if (valueLed2 === 1) {
            statusLed2.innerHTML = 'RELAY 2 ƒëang b·∫≠t';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang b·∫≠t
            statusLed2.classList.add('on');
            statusLed2.classList.remove('off');
            relayLight2.classList.add('on');
            relayBox2.classList.add('on');
          } else {
            statusLed2.innerHTML = 'RELAY 2 ƒëang t·∫Øt';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang t·∫Øt
            statusLed2.classList.remove('on');
            statusLed2.classList.add('off');
            relayLight2.classList.remove('on');
            relayBox2.classList.remove('on');
          }
        }
        if (newStatusLed3 !== valueLed3) {
          newStatusLed3 = valueLed3;
          const relayBox3 = document.getElementById('relayBox3');
          const relayLight3 = document.getElementById('relayLight3');
          if (valueLed3 === 1) {
            statusLed3.innerHTML = ' RELAY 3  ƒëang b·∫≠t';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang b·∫≠t
            statusLed3.classList.add('on');
            statusLed3.classList.remove('off');
            relayLight3.classList.add('on');
            relayBox3.classList.add('on');
          } else {
            statusLed3.innerHTML = 'RELAY 3 ƒëang t·∫Øt';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang t·∫Øt
            statusLed3.classList.remove('on');
            statusLed3.classList.add('off');
            relayLight3.classList.remove('on');
            relayBox3.classList.remove('on');
          }
        }
        if (newStatusLed4 !== valueLed4) {
          newStatusLed4 = valueLed4;
          const relayBox4 = document.getElementById('relayBox4');
          const relayLight4 = document.getElementById('relayLight4');
          if (valueLed4 === 1) {
            statusLed4.innerHTML = 'RELAY 4 ƒëang b·∫≠t';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang b·∫≠t
            statusLed4.classList.add('on');
            statusLed4.classList.remove('off');
            relayLight4.classList.add('on');
            relayBox4.classList.add('on');
          } else {
            statusLed4.innerHTML = 'RELAY 4 ƒëang t·∫Øt';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang t·∫Øt
            statusLed4.classList.remove('on');
            statusLed4.classList.add('off');
            relayLight4.classList.remove('on');
            relayBox4.classList.remove('on');
          }
        }
        if (newStatusLed5 !== valueLed5) {
          newStatusLed5 = valueLed5;
          const relayBox5 = document.getElementById('relayBox5');
          const relayLight5 = document.getElementById('relayLight5');
          if (valueLed5 === 1) {
            statusLed5.innerHTML = 'RELAY 5 ƒëang b·∫≠t';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang b·∫≠t
            statusLed5.classList.add('on');
            statusLed5.classList.remove('off');
            relayLight5.classList.add('on');
            relayBox5.classList.add('on');
          } else {
            statusLed5.innerHTML = 'RELAY 5 ƒëang t·∫Øt';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang t·∫Øt
            statusLed5.classList.remove('on');
            statusLed5.classList.add('off');
            relayLight5.classList.remove('on');
            relayBox5.classList.remove('on');
          }
        }
        if (newStatusLed6 !== valueLed6) {
          newStatusLed6 = valueLed6;
          const relayBox6 = document.getElementById('relayBox6');
          const relayLight6 = document.getElementById('relayLight6');
          if (valueLed6 === 1) {
            statusLed6.innerHTML = 'RELAY 6 ƒëang b·∫≠t';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang b·∫≠t
            statusLed6.classList.add('on');
            statusLed6.classList.remove('off');
            relayLight6.classList.add('on');
            relayBox6.classList.add('on');
          } else {
            statusLed6.innerHTML = 'RELAY 6 ƒëang t·∫Øt';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang t·∫Øt
            statusLed6.classList.remove('on');
            statusLed6.classList.add('off');
            relayLight6.classList.remove('on');
            relayBox6.classList.remove('on');
          }
        }
        if (newStatusLed7 !== valueLed7) {
          newStatusLed7 = valueLed7;
          const relayBox7 = document.getElementById('relayBox7');
          const relayLight7 = document.getElementById('relayLight7');
          if (valueLed7 === 1) {
            statusLed7.innerHTML = 'RELAY 7 ƒëang b·∫≠t';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang b·∫≠t
            statusLed7.classList.add('on');
            statusLed7.classList.remove('off');
            relayLight7.classList.add('on');
            relayBox7.classList.add('on');
          } else {
            statusLed7.innerHTML = 'RELAY 7 ƒëang t·∫Øt';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang t·∫Øt
            statusLed7.classList.remove('on');
            statusLed7.classList.add('off');
            relayLight7.classList.remove('on');
            relayBox7.classList.remove('on');
          }
        }
        if (newStatusLed8 !== valueLed8) {
          newStatusLed8 = valueLed8;
          const relayBox8 = document.getElementById('relayBox8');
          const relayLight8 = document.getElementById('relayLight8');
          if (valueLed8 === 1) {
            statusLed8.innerHTML = 'RELAY 8 ƒëang b·∫≠t';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang b·∫≠t
            statusLed8.classList.add('on');
            statusLed8.classList.remove('off');
            relayLight8.classList.add('on');
            relayBox8.classList.add('on');
          } else {
            statusLed8.innerHTML = 'RELAY 8 ƒëang t·∫Øt';  // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë√®n LED ƒëang t·∫Øt
            statusLed8.classList.remove('on');
            statusLed8.classList.add('off');
            relayLight8.classList.remove('on');
            relayBox8.classList.remove('on');
          }
        }
        if (newProtectFrom !== fromValue) {
          newSProtectFrom = fromValue;
          if (fromValue === 1) {
            inputProtectFrom.innerHTML = '10';  
          } else {
            inputProtectFrom.innerHTML = '0';  
          }
        }
      },
    });
    turnOnrelay1.addEventListener('click', () => {
      eraWidget.triggerAction(actions1[0]?.action, null);
    });
    turnOffrelay1.addEventListener('click', () => {
      eraWidget.triggerAction(actions1[1]?.action, null);
    });

    // ƒêi·ªÅu khi·ªÉn relay 2
    turnOnrelay2.addEventListener('click', () => {
      eraWidget.triggerAction(actions2[0]?.action, null);
    });
    turnOffrelay2.addEventListener('click', () => {
      eraWidget.triggerAction(actions2[1]?.action, null);
    });

    // ƒêi·ªÅu khi·ªÉn relay 3
    turnOnrelay3.addEventListener('click', () => {
      eraWidget.triggerAction(actions3[0]?.action, null);
    });
    turnOffrelay3.addEventListener('click', () => {
      eraWidget.triggerAction(actions3[1]?.action, null);
    });
    turnOnrelay4.addEventListener('click', () => {
      eraWidget.triggerAction(actions4[0]?.action, null);
    });
    turnOffrelay4.addEventListener('click', () => {
      eraWidget.triggerAction(actions4[1]?.action, null);
    });
    turnOnrelay5.addEventListener('click', () => {
      eraWidget.triggerAction(actions5[0]?.action, null);
    });
    turnOffrelay5.addEventListener('click', () => {
      eraWidget.triggerAction(actions5[1]?.action, null);
    });
    turnOnrelay6.addEventListener('click', () => {
      eraWidget.triggerAction(actions6[0]?.action, null);
    });
    turnOffrelay6.addEventListener('click', () => {
      eraWidget.triggerAction(actions6[1]?.action, null);
    });
    turnOnrelay7.addEventListener('click', () => {
      eraWidget.triggerAction(actions7[0]?.action, null);
    });
    turnOffrelay7.addEventListener('click', () => {
      eraWidget.triggerAction(actions7[1]?.action, null);
    });
    turnOnrelay8.addEventListener('click', () => {
      eraWidget.triggerAction(actions8[0]?.action, null);
    });
    turnOffrelay8.addEventListener('click', () => {
      eraWidget.triggerAction(actions8[1]?.action, null);
    });
    sendProtect.addEventListener("click", () => {
      eraWidget.triggerAction(actions9[0]?.action, null);
      const fromValue = inputProtectFrom.value.trim();
      if (fromValue === "") {
        alert("Vui l√≤ng nh·∫≠p gi√° tr·ªã (v√≠ d·ª•: 10 ho·∫∑c 0)");
        return;
      }

      //  C·∫≠p nh·∫≠t realtime config ‚Äî g·ª≠i l√™n ERA Cloud
      eraWidget.updateRealtimeConfig(configProtectFrom.id, fromValue);

      //  Log ra console ƒë·ªÉ d·ªÖ ki·ªÉm tra
      console.log("ƒê√£ g·ª≠i gi√° tr·ªã b·∫£o v·ªá l√™n ERA:", fromValue);
    });
  </script>
</body>
</html>
